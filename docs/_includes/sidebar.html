<section class="site site-sidebar slds-order_2">
  <div class="site-banner">
  	<br/>
    <div class="site-logo">
       
      {% assign rootLink = site.baseurl | append: '/' %}

      <a href="{{ rootLink }}" class="slds-m-vertical--x-small D(b)">
      	<span class="site-logo__graphic"><img src="./assets/images/sfdx_scanner_logo.png"/>
        </span>
        </a>
  </div><br/><br/><br/>

  <div class="language-picker">

    {% if page.url == '' %} 
      {% assign ver3url = page.url | append: '/en/v3.x/' %} 
      {% assign ver2url = page.url | append: '/' %} 
    {% elsif page.url == '/' %} 
      {% assign ver3url = page.url | append: 'en/v3.x/' %} 
      {% assign ver2url = page.url %} 
    {% else %}
      {% assign ver3url = '/en/v3.x' %}
      {% assign ver2url = '/' %}
    {% endif %}

    <a
        class="{% unless page.path contains 'v3.x' %}is-selected{% endunless %}"
        href="{{ ver2url | prepend: site.baseurl }}"
        translate="no"
        >v2.x</a
      >
      |
      <a
        class="{% if page.path contains 'v3.x' %}is-selected{% endif %}"
        href="{{ ver3url | prepend: site.baseurl }}"
        translate="no"
        >v3.x</a
      >
  </div>

  <!-- when we are ready to make v3 the default, swap this out -->
  {% assign sidebar = site.data.sidebar-v2 %}

  {% if page.path contains 'v3.x' %}
    {% assign sidebar = site.data.sidebar-v3 %}
  {% endif %}
  
  <div
    id="site-navigation"
    class="site site-navigation site-navigation--has-search"
  >
    <nav
      id="navigation"
      role="navigation"
      tabindex="-1"
      aria-label="Main navigation"
    >
      <ul class="slds-list_vertical slds-has-block-links">
        {% for item in sidebar %} {% if page.url contains item.baseUrl
        %}
        <li class="list__item slds-is-open slds-is-selected">
          <button class="slds-button_reset" aria-expanded="true">
            <span class="slds-media slds-media--center">
              <span class="slds-media__body">{{ item.title[page.lang] }}</span
              ><span class="slds-media__figure--reverse">
                <svg
                  class="slds-icon slds-icon__svg slds-icon-utility-right slds-icon--small"
                  aria-hidden="true"
                  style="transform: rotate(90deg);"
                >
                  <use
                    xlink:href="{{
                      '/assets/icons/utility-sprite/svg/symbols.svg#right'
                        | prepend: site.baseurl
                    }}"
                  ></use>
                </svg>
              </span>
            </span>
          </button>
          <ul class="slds-list_vertical slds-has-block-links slds-is-nested">
            {% for entry in item.children %}
            <li
              class="list__item {% if page.url contains entry.url %}slds-is-selected slds-is-active{% endif %}"
            >
              <a
                href="{{
                  entry.url
                    | prepend: page.lang
                    | prepend: '/'
                    | prepend: site.baseurl
                }}"
              >
                <span class="slds-media slds-media--center">
                  <span class="slds-media__body"
                    >{{ entry.title[page.lang] }}</span
                  >
                </span>
              </a>
            </li>
            {% endfor %}
          </ul>
        </li>
        {% else %} {% if item.url %}
        <li
          class="list__item {% if page.url contains item.url %}slds-is-selected slds-is-active{% endif %}"
        >
          <a
            href="{{
              item.url
                | prepend: page.lang
                | prepend: '/'
                | prepend: site.baseurl
            }}"
          >
            <span class="slds-media slds-media--center">
              <span class="slds-media__body">{{ item.title[page.lang] }}</span>
            </span>
          </a>
        </li>
        {% else %}
        <li class="list__item">
          <a
            href="{{
              item.children.first.url
                | prepend: page.lang
                | prepend: '/'
                | prepend: site.baseurl
            }}"
          >
            <span class="slds-media slds-media--center">
              <span class="slds-media__body">{{ item.title[page.lang] }}</span>
            </span>
          </a>
          <ul
            class="slds-list_vertical slds-has-block-links slds-is-nested"
            style="display: none;"
          >
            {% for entry in item.children %}
            <li
              class="list__item {% if page.url contains entry.url %}slds-is-selected slds-is-active{% endif %}"
            >
              <a
                href="{{
                  entry.url
                    | prepend: page.lang
                    | prepend: '/'
                    | prepend: site.baseurl
                }}"
              >
                <span class="slds-media slds-media--center">
                  <span class="slds-media__body"
                    >{{ entry.title[page.lang] }}</span
                  >
                </span>
              </a>
            </li>
            {% endfor %}
          </ul>
        </li>
        {% endif %} {% endif %} {% endfor %}
      </ul>
    </nav>
  </div>
</section>
